const search=document.querySelector(".input-group input"),table_rows=document.querySelectorAll("tbody tr"),table_headings=document.querySelectorAll("thead th");function searchTable(){table_rows.forEach(((e,t)=>{let o=e.textContent.toLowerCase(),n=search.value.toLowerCase();e.classList.toggle("hide",o.indexOf(n)<0),e.style.setProperty("--delay",t/25+"s")})),document.querySelectorAll("tbody tr:not(.hide)").forEach(((e,t)=>{e.style.backgroundColor=t%2==0?"transparent":"#0000000b"}))}function sortTable(e,t){[...table_rows].sort(((o,n)=>{let l=o.querySelectorAll("td")[e].textContent.toLowerCase(),c=n.querySelectorAll("td")[e].textContent.toLowerCase();return t?l<c?1:-1:l<c?-1:1})).map((e=>document.querySelector("tbody").appendChild(e)))}search.addEventListener("input",searchTable),table_headings.forEach(((e,t)=>{let o=!0;e.onclick=()=>{table_headings.forEach((e=>e.classList.remove("active"))),e.classList.add("active"),document.querySelectorAll("td").forEach((e=>e.classList.remove("active"))),table_rows.forEach((e=>{e.querySelectorAll("td")[t].classList.add("active")})),e.classList.toggle("asc",o),o=!e.classList.contains("asc"),sortTable(t,o)}}));const pdf_btn=document.querySelector("#toPDF"),customers_table=document.querySelector("#customers_table"),toPDF=function(e){const t=`\n    <!DOCTYPE html>\n    <link rel="stylesheet" type="text/css" href="style.css">\n    <main class="table" id="customers_table">${e.innerHTML}</main>`,o=window.open();o.document.write(t),setTimeout((()=>{o.print(),o.close()}),400)};pdf_btn.onclick=()=>{toPDF(customers_table)};const json_btn=document.querySelector("#toJSON"),toJSON=function(e){let t=[],o=[],n=e.querySelectorAll("th"),l=e.querySelectorAll("tbody tr");for(let e of n){let t=e.textContent.trim().split(" ");o.push(t.splice(0,t.length-1).join(" ").toLowerCase())}return l.forEach((e=>{const n={};e.querySelectorAll("td").forEach(((e,t)=>{const l=e.querySelector("img");l&&(n["customer image"]=decodeURIComponent(l.src)),n[o[t]]=e.textContent.trim()})),t.push(n)})),JSON.stringify(t,null,4)};json_btn.onclick=()=>{const e=toJSON(customers_table);downloadFile(e,"json")};const csv_btn=document.querySelector("#toCSV"),toCSV=function(e){const t=e.querySelectorAll("th"),o=e.querySelectorAll("tbody tr");return[...t].map((e=>{let t=e.textContent.trim().split(" ");return t.splice(0,t.length-1).join(" ").toLowerCase()})).join(",")+",image name"+"\n"+[...o].map((e=>{const t=e.querySelectorAll("td"),o=decodeURIComponent(e.querySelector("img").src);return[...t].map((e=>e.textContent.replace(/,/g,".").trim())).join(",")+","+o})).join("\n")};csv_btn.onclick=()=>{const e=toCSV(customers_table);downloadFile(e,"csv","customer orders")};const excel_btn=document.querySelector("#toEXCEL"),toExcel=function(e){const t=e.querySelectorAll("th"),o=e.querySelectorAll("tbody tr");return[...t].map((e=>{let t=e.textContent.trim().split(" ");return t.splice(0,t.length-1).join(" ").toLowerCase()})).join("\t")+"\timage name"+"\n"+[...o].map((e=>{const t=e.querySelectorAll("td"),o=decodeURIComponent(e.querySelector("img").src);return[...t].map((e=>e.textContent.trim())).join("\t")+"\t"+o})).join("\n")};excel_btn.onclick=()=>{const e=toExcel(customers_table);downloadFile(e,"excel")};const downloadFile=function(e,t,o=""){const n=document.createElement("a");n.download=o;n.href=`\n        data:${{json:"application/json",csv:"text/csv",excel:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}[t]};charset=utf-8,${encodeURIComponent(e)}\n    `,document.body.appendChild(n),n.click(),n.remove()};